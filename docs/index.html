<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Japan Adventure Planner</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #fafaf9; /* Stone 50 */
            color: #44403c; /* Stone 700 */
        }
        
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }

        .active-tab {
            border-bottom: 2px solid #ea580c; /* Orange 600 */
            color: #ea580c;
            font-weight: 600;
        }

        .inactive-tab {
            color: #78716c; /* Stone 500 */
        }
        
        .inactive-tab:hover {
            color: #ea580c;
        }

        /* Card hover effects */
        .interactive-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            cursor: pointer;
        }
        .interactive-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        /* Table style */
       table {
            width: 100%; /* Increased table width slightly */
            border-collapse: collapse;
            margin: 20px 0;
            font-family: Arial, sans-serif;
        }
        th, td {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
            vertical-align: middle;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
        /* Style for the list inside the cell */
        td ul {
            list-style-type: none; 
            padding: 0;
            margin: 0;
        }
        /* Total Row Styling */
        tfoot td { 
            background-color: #e0f7fa; 
            font-weight: bold; 
            border-top: 2px solid; 
            font-size: 1.1em;
        }
        /* *** NEW CSS: Making the 'Seats Assigned' column wider *** */
        .seats-column {
            width: 15%; /* Assigns 25% of the table's total width to this column */
        }

        .packed-text {
            text-decoration: line-through;
            color: #a1a1aa; /* text-stone-400 */
        }
        .input-group input { 
            padding: 10px; border: 1px solid #ccc; border-radius: 4px; flex-grow: 1; 
        }
    </style>

</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <span class="text-2xl font-bold text-stone-800 tracking-tight">üáØüáµ Japan<span class="text-orange-600">Plan</span></span>
                </div>
                <!-- Navigation -->
                <nav class="hidden md:flex space-x-8">
                    <button onclick="app.switchTab('logistic')" id="nav-logistic" class="active-tab px-1 pt-1 text-sm font-medium focus:outline-none transition duration-150">Logistic</button>
                    <button onclick="app.switchTab('itinerary')" id="nav-itinerary" class="active-tab px-1 pt-1 text-sm font-medium focus:outline-none transition duration-150">Itinerary</button>
                    <button onclick="app.switchTab('cultural-tips')" id="nav-cultural-tips" class="inactive-tab px-1 pt-1 text-sm font-medium focus:outline-none transition duration-150">Cultural Tips</button>
                    <button onclick="app.switchTab('checklist')" id="nav-checklist" class="inactive-tab px-1 pt-1 text-sm font-medium focus:outline-none transition duration-150">Checklist</button>
                    <button onclick="app.switchTab('budget')" id="nav-budget" class="inactive-tab px-1 pt-1 text-sm font-medium focus:outline-none transition duration-150">Budget</button>
                </nav>
                <!-- Mobile Menu Button (simplified interaction for single file) -->
                <div class="md:hidden">
                    <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="text-stone-500 hover:text-stone-900 focus:outline-none">
                        Menu
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-stone-200">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <button onclick="app.switchTab('logistic'); document.getElementById('mobile-menu').classList.add('hidden')" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium text-stone-700 hover:text-orange-600 hover:bg-stone-50">Logistic</button>
                <button onclick="app.switchTab('itinerary'); document.getElementById('mobile-menu').classList.add('hidden')" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium text-stone-700 hover:text-orange-600 hover:bg-stone-50">Itinerary</button>
                <button onclick="app.switchTab('cultural-tips'); document.getElementById('mobile-menu').classList.add('hidden')" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium text-stone-700 hover:text-orange-600 hover:bg-stone-50">Cultural Tips</button>
                <button onclick="app.switchTab('checklist'); document.getElementById('mobile-menu').classList.add('hidden')" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium text-stone-700 hover:text-orange-600 hover:bg-stone-50">Checklist</button>
                <button onclick="app.switchTab('budget'); document.getElementById('mobile-menu').classList.add('hidden')" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium text-stone-700 hover:text-orange-600 hover:bg-stone-50">Budget</button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">
        
        <!-- INTRO HERO
        <div id="app-intro" class="mb-8 text-center max-w-3xl mx-auto">
            <h1 class="text-4xl font-extrabold text-stone-900 mb-4">Your Two-Week Golden Route</h1>
            <p class="text-lg text-stone-600">
                Welcome to your interactive planner. Based on your "Golden Route" itinerary, this tool helps you explore the balance between modern cities and traditional culture. Navigate through the tabs to visualize your time, plan your meals, and prepare your logistics.
            </p>
        </div> -->

        <!-- VIEW: LOGISTIC -->
        <div id="view-logistic" class="block space-y-8 animate-fade-in">
                <!-- Text Content -->
                <div class="lg:col-span-2 space-y-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                        <h1 class="text-2xl font-bold text-stone-800 mb-4 border-l-4 border-orange-500 pl-3">Flight Details </h1>
                        <table>
                            <thead>
                                <tr>
                                    <th>Direction</th>
                                    <th>Airline</th>
                                    <th>Flight No.</th>
                                    <th>Departure Day</th>
                                    <th>Departure Time</th>
                                    <th>Arrival Day</th>
                                    <th>Arrival Time</th>
                                    <th>Duration</th>
                                    <th class="seats-column">Seats</th>
                                    <th>Price ¬£</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>London-Tokyo</td>
                                    <td>British Airways</td>
                                    <td>BA007</td>
                                    <td>Friday X Nov</td>
                                    <td>16:00 (GMT)</td>
                                    <td>Saturday Y Nov</td>
                                    <td>17:00 (JST)</td>
                                    <td>7h50</td>
                                    <td><ul>
                                        <li>Adina: 12A</li>
                                        <li>Maria: 12B</li>
                                        <li>Melodie: 35F</li>
                                        <li>Oksana: 36F</li>
                                    </ul></td>
                                    <td>¬£650.00</td>
                                </tr>
                                <tr>
                                    <td>Toky-London</td>
                                    <td>Japan Airlines</td>
                                    <td>JL44</td>
                                    <td>Saturday X Nov</td>
                                    <td>06:15 (JST)</td>
                                    <td>Sunday X Nov</td>
                                    <td>12:15 (GMT)</td>
                                    <td>7h10</td>
                                    <td><ul>
                                        <li>Adina: 12A</li>
                                        <li>Maria: 12B</li>
                                        <li>Melodie: 35F</li>
                                        <li>Oksana: 36F</li>
                                    </ul></td>
                                    <td>¬£720.00</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                        <h2 class="text-2xl font-bold text-stone-800 mb-4 border-l-4 border-orange-500 pl-3">Accomodation üè†</h2>
                        <!-- Interactive City Selector -->
                        <div class="space-y-4">
                            <!-- City Cards injected by JS -->
                            <div id="logistic-list" class="space-y-3"></div>
                        </div>
                    </div>
                </div>

            <!-- </div> -->
        </div>
        
        <!-- VIEW: ITINERARY -->
        <div id="view-itinerary" class="block space-y-8 animate-fade-in">
            <div class="max-w-4xl mx-auto">
        
                <header class="text-center mb-10">
                    <h1 class="text-5xl font-extrabold text-gray-900 mb-2">Japan Itinerary</h1>
                    <p class="text-xl text-gray-600">3-Day Central Itinerary: Culture, Tech, and Neon Lights</p>
                </header>
                    <div class="space-y-8">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center">
                            <span class="mr-3">‚òÄÔ∏è</span> Day 1: Asakusa & Shibuya
                        </h2>
                        <ol class="space-y-4">
                            <li>
                                Morning (9:00 AM): Visit the ancient Senso-ji Temple in Asakusa. Walk down the historic Nakamise-dori street for souvenirs.
                            </li>
                            <li>
                                Lunch (1:00 PM): Enjoy a traditional tempura or soba lunch near the temple.
                            </li>
                            <li>
                                Afternoon (3:00 PM): Head to Shibuya. Cross the iconic Shibuya Scramble Crossing**.
                            </li>
                            <li>
                                Evening (7:00 PM):Dinner in Shibuya. Find a spot overlooking the crossing or explore the lively Nonbei Yokocho (Drunkard's Alley).
                            </li>
                        </ol>
                    </div>

            <div class="bg-white p-6 rounded-xl shadow-lg border-l-8 border-indigo-500">
                <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="mr-3">üèôÔ∏è</span> Day 2: Shinjuku & Meiji Shrine
                </h2>
                <ol class="space-y-4">
                    <li class="border-b pb-2">
                        <span class="font-semibold text-indigo-600">Morning (10:00 AM):</span> 
                        Find tranquility at the **Meiji Jingu Shrine**, a large forest sanctuary dedicated to Emperor Meiji.
                    </li>
                    <li class="border-b pb-2">
                        <span class="font-semibold text-indigo-600">Lunch (1:00 PM):</span> 
                        Explore **Harajuku** (next to Meiji Shrine). Grab a quirky crepe or a stylish bowl of ramen.
                    </li>
                    <li class="border-b pb-2">
                        <span class="font-semibold text-indigo-600">Afternoon (3:00 PM):</span> 
                        Go up the **Tokyo Metropolitan Government Building** in Shinjuku for free city views.
                    </li>
                    <li class="pb-2">
                        <span class="font-semibold text-indigo-600">Evening (8:00 PM):</span> 
                        Experience Shinjuku's nightlife. Visit **Golden Gai** for tiny, atmospheric bars or **Omoide Yokocho** (Piss Alley) for grilled skewers.
                    </li>
                </ol>
            </div>

            <div class="bg-white p-6 rounded-xl shadow-lg border-l-8 border-teal-500">
                <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center">
                    <span class="mr-3">üóº</span> Day 3: Akihabara & Ginza
                </h2>
                <ol class="space-y-4">
                    <li class="border-b pb-2">
                        <span class="font-semibold text-teal-600">Morning (11:00 AM):</span> 
                        Dive into **Akihabara**, the electric town. Explore electronics, anime, and gaming shops.
                    </li>
                    <li class="border-b pb-2">
                        <span class="font-semibold text-teal-600">Lunch (1:00 PM):</span> 
                        Find a themed caf√© or a fast-casual eatery in Akihabara.
                    </li>
                    <li class="border-b pb-2">
                        <span class="font-semibold text-teal-600">Afternoon (3:00 PM):</span> 
                        Switch gears and explore the upscale district of **Ginza** for high-end shopping and architecture.
                    </li>
                    <li class="pb-2">
                        <span class="font-semibold text-teal-600">Evening (6:00 PM):</span> 
                        View the city from the **Tokyo Skytree** or **Tokyo Tower**, followed by a final dinner.
                    </li>
                </ol>
            </div>

        </div>

        <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100 h-full">
                            <h4 class="font-bold text-blue-800 text-sm mb-1">üöÑ Travel Tip</h4>
                            <p class="text-xs text-blue-700">The <strong>Shinkansen</strong> connects these hubs. A 14-day JR Pass is recommended for seamless travel between Tokyo, Kyoto, Osaka, and Hiroshima/Day Trips.</p>
                    </div>

    </div>
            
        </div>

        <!-- VIEW: CULTURAL TIPS -->
        <div id="view-cultural-tips" class="hidden space-y-8">
            <div class="max-w-4xl mx-auto text-center mb-8">
                <h2 class="text-3xl font-bold text-stone-900">Cultural Immersion & Experiences</h2>
                <p class="mt-2 text-stone-600">The trip prioritizes hands-on cultural moments. Click on the cards below to uncover the essential activities identified in your report.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" id="experience-grid">
                <!-- Experience Cards Injected JS -->
            </div>

            <!-- Etiquette Section -->
            <div class="bg-indigo-50 rounded-2xl p-8 mt-8">
                <div class="flex flex-col md:flex-row items-start md:items-center justify-between mb-6">
                    <div>
                        <h3 class="text-xl font-bold text-indigo-900">üáØüáµ Essential Etiquette</h3>
                        <p class="text-indigo-700">Respect the local customs to deepen your connection.</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-sm">
                    <div class="bg-white p-4 rounded-lg shadow-sm">
                        <div class="text-2xl mb-2">üëü</div>
                        <h4 class="font-bold text-gray-900">Footwear</h4>
                        <p class="text-gray-600">Always remove shoes at temple interiors, Ryokans, and private homes. Look for the designated genkan area.</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-sm">
                        <div class="text-2xl mb-2">üí¥</div>
                        <h4 class="font-bold text-gray-900">Tipping</h4>
                        <p class="text-gray-600"><strong>Do not tip.</strong> Excellent service is the standard. Tipping can be confusing or considered rude.</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-sm">
                        <div class="text-2xl mb-2">ü§´</div>
                        <h4 class="font-bold text-gray-900">Public Silence</h4>
                        <p class="text-gray-600">Keep your voice down on public transport. Avoid phone calls on trains.</p>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-2">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                        <h2 class="text-2xl font-bold text-stone-800 mb-6 border-l-4 border-red-500 pl-3">Culinary Goals</h2>
                        <p class="text-stone-600 mb-6">From street food to refined sushi, here is your checklist of must-try flavors.</p>
                        
                        <!-- Food Filters -->
                        <div class="flex space-x-2 mb-6 overflow-x-auto pb-2">
                            <button onclick="app.filterFood('all')" class="px-4 py-2 bg-stone-100 hover:bg-stone-200 rounded-full text-sm font-semibold transition">All</button>
                            <button onclick="app.filterFood('Noodle')" class="px-4 py-2 bg-stone-100 hover:bg-stone-200 rounded-full text-sm font-semibold transition">Noodles</button>
                            <button onclick="app.filterFood('Street Food')" class="px-4 py-2 bg-stone-100 hover:bg-stone-200 rounded-full text-sm font-semibold transition">Street Food</button>
                            <button onclick="app.filterFood('Seafood')" class="px-4 py-2 bg-stone-100 hover:bg-stone-200 rounded-full text-sm font-semibold transition">Seafood</button>
                        </div>

                        <!-- Food Grid -->
                        <div id="food-grid" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <!-- Injected by JS -->
                        </div>
                    </div>
                </div>

                <!-- Visualization -->
                <!-- <div class="lg:col-span-1">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                        <h3 class="text-lg font-semibold text-stone-800 mb-2">Dining Style Mix</h3>
                        <p class="text-sm text-stone-500 mb-6">Balance your meals between quick bites and sit-down experiences.</p>
                        
                         CHART CONTAINER 
                        <div class="chart-container">
                            <canvas id="foodChart"></canvas>
                        </div>
                        
                        <div class="mt-6 border-t pt-4">
                             <h4 class="font-bold text-stone-800 text-sm mb-2">Legend:</h4>
                             <ul class="text-sm space-y-1 text-stone-600">
                                 <li>üçú <span class="font-semibold">Noodles:</span> Quick, hearty lunches.</li>
                                 <li>üêô <span class="font-semibold">Street Food:</span> Casual evening snacks (Osaka).</li>
                                 <li>üç£ <span class="font-semibold">Seafood:</span> Fresh, often raw delicacies.</li>
                             </ul>
                        </div>
                    </div>
                </div> -->
        </div>

        <!-- VIEW: CHECKLIST -->
        <div id="view-checklist" class="hidden space-y-8">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Packing Checklist -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                    <h2 class="text-xl font-bold text-stone-800 mb-4 flex items-center">
                        <span class="bg-blue-100 text-blue-700 p-2 rounded-full mr-3">üé´</span> 
                        Packing Essentials
                    </h2>
                    <p class="text-stone-600 text-sm mb-6">Key items for smooth travel.</p>
                    
                    <ul class="space-y-3" id="packing-list">
                        <!-- JS injected -->
                    </ul>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                    <h2 class="text-xl font-bold text-stone-800 mb-4 flex items-center">
                        <span class="bg-blue-100 text-blue-700 p-2 rounded-full mr-3">üëï</span> 
                        Clothing
                    </h2>
                    <p class="text-stone-600 text-sm mb-6">Clothing for 13 days.</p>
                    
                    <ul class="space-y-3" id="packing2-list">
                        <!-- JS injected -->
                    </ul>
                </div>
            </div>
        </div>

        <!-- VIEW: BUDGET -->
        <div id="view-budget" class="hidden space-y-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                
                <!-- Budgeting Tool -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                    <h2 class="text-xl font-bold text-stone-800 mb-4 flex items-center">
                        <span class="bg-green-100 text-green-700 p-2 rounded-full mr-3">üí∑</span> 
                        Budget Converter
                    </h2>
                    <p class="text-stone-600 text-sm mb-6">
                        Use the current favorable exchange rate to estimate your spending power. 
                        <br><span class="text-xs text-stone-400">Rate: ¬£1 = ¬•206.82</span>
                    </p>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-stone-700 mb-1">British Pounds (¬£)</label>
                            <input type="number" id="gbp-input" placeholder="e.g. 100" class="w-full p-3 border border-stone-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none transition" oninput="app.convertCurrency()">
                        </div>
                        <div class="flex justify-center text-stone-400">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-stone-700 mb-1">Japanese Yen (¬•)</label>
                            <div id="jpy-output" class="w-full p-3 bg-stone-50 border border-stone-200 rounded-lg text-stone-800 font-mono font-bold text-lg">
                                ¬• 0
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 bg-yellow-50 p-4 rounded-lg border border-yellow-100">
                        <h4 class="text-yellow-800 font-bold text-sm">üí° Cash is King</h4>
                        <p class="text-yellow-700 text-xs mt-1">Remember that many smaller shops, temples, and restaurants still only accept cash (Yen). Always carry sufficient notes.</p>
                    </div>
                </div>


                <div class="container">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100">
                        <h2 class="text-xl font-bold text-stone-800 mb-4 flex items-center">
                            <span class="bg-green-100 text-green-700 p-2 rounded-full mr-3">üí∞</span> 
                            Expense Tracker
                        </h2>

                        <div class="input-group">
                            <input type="text" id="expense-item" placeholder="Item Name (e.g., Lunch)">
                            <input type="number" id="expense-cost" placeholder="Cost (¬£)" min="0" step="0.01">
                            <button onclick="addExpense()">Add Expense</button>
                        </div>

                        <table>
                            <thead>
                                <tr>
                                    <th>Item</th>
                                    <th class="text-right">Cost (¬£)</th>
                                    <th></th> </tr>
                            </thead>
                            <tbody id="expense-list">
                                </tbody>
                            <tfoot>
                                <tr>
                                    <td>**TOTAL SPENT**</td>
                                    <td id="total-cost" class="text-right">¬£ 0.00</td>
                                    <td></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-stone-800 text-stone-300 py-8 mt-auto">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-sm">Generated for your Japan Adventure Planning. &copy; 2025</p>
        </div>
    </footer>

    <!-- LOGIC -->
    <script>
        const app = {
            state: {
                currentTab: 'logistic',
                exchangeRate: 206.82,
                itineraryData: [
                    { 
                        city: "Tokyo", 
                        days: 5,
                        tags: ["Modernity", "Pop Culture", "Nightlife"],
                        desc: "Shibuya Crossing, Meiji Jingu Shrine, Senso-ji Temple, Shinjuku (Golden Gai). The electric capital." 
                    },
                    { 
                        city: "Kyoto", 
                        days: 5,
                        tags: ["Tradition", "History", "Arts"],
                        desc: "Fushimi Inari Taisha (Torii Gates), Kinkaku-ji (Golden Pavilion), Arashiyama Bamboo Grove, Gion District." 
                    },
                    { 
                        city: "Osaka", 
                        days: 2,
                        tags: ["Food", "Entertainment"],
                        desc: "Dotonbori for street food, Osaka Castle. The kitchen of Japan." 
                    },
                    { 
                        city: "Day Trips", 
                        days: 2,
                        tags: ["Nature", "History"],
                        desc: "Nara Park (Deer & Todai-ji), Hakone or Kawaguchiko (Mt Fuji views)." 
                    }
                ],
                logisticData: [
                    { 
                        city: "The Royal Park Hotel Iconic Tokyo Shiodome", 
                        days: 2,
                        shortDesc: "üóìÔ∏è Saturday 15th to Monday 18th November.", 
                        fullDesc: "Hotel in the center of Tokyo, easy to reach.",
                        bookingLink: "https://www.booking.com/hotel/jp/royalpark-shiodometower.en-gb.html?aid=304142&label=gen173nr-10CAEoggI46AdIM1gEaFCIAQGYATO4AQfIAQzYAQPoAQH4AQGIAgGoAgG4AsP51skGwAIB0gIkM2M2NDQ5ZWQtYTI3NC00N2IzLTllYTUtOGE4Y2U2ZTc4ODg02AIB4AIB&sid=3dd0fcd30807bcf5534d5cc5b76fa068&all_sr_blocks=25488924_414406860_2_2_0_370502&checkin=2026-04-06&checkout=2026-04-08&dest_id=-246227&dest_type=city&dist=0&group_adults=2&group_children=0&hapos=3&highlighted_blocks=25488924_414406860_2_2_0_370502&hpos=3&matching_block_id=25488924_414406860_2_2_0_370502&no_rooms=1&req_adults=2&req_children=0&room1=A%2CA&sb_price_type=total&sr_order=popularity&sr_pri_blocks=25488924_414406860_2_2_0_370502_9574400&srepoch=1765129461&srpvid=4cfa7cb477b208d0&type=total&ucfs=1&",
                        mapLink: "https://maps.app.goo.gl/e79BMWtuwxYmE8idA"
                        
                    },
                    { 
                        city: "Flat 2 - Kyoto", 
                        days: 5,
                        shortDesc: "Fushimi Inari Taisha, Kinkaku-ji, Arashiyama Bamboo Grove. The city of tradition.", 
                        fullDesc: "A traditional Machiya-style house near the Gion district. Experience classic Japanese architecture with all modern comforts. Close to major temples.",
                        bookingLink: "https://www.example.com/flat2-kyoto",
                        mapLink: "https://maps.app.goo.gl/tokyo_flat_location"
                    },
                    { 
                        city: "Flat 3 - Osaka", 
                        days: 2,
                        shortDesc: "Dotonbori for street food, Osaka Castle. The kitchen of Japan.", 
                        fullDesc: "Centrally located apartment ideal for food lovers. Right next to Namba station, making travel to Kyoto and Nara easy and fast.",
                        bookingLink: "https://www.example.com/flat3-osaka",
                        mapLink: "https://maps.app.goo.gl/tokyo_flat_location"
                    }
                ],
                experiences: [
                    { title: "Ryokan Stay", icon: "üõå", desc: "Sleep on tatami mats and enjoy traditional hospitality.", type: "Accommodation" },
                    { title: "Onsen", icon: "‚ô®Ô∏è", desc: "Relax in a natural hot spring bath (naked, gender-separated).", type: "Wellness" },
                    { title: "Tea Ceremony", icon: "üçµ", desc: "Participate in a meditative matcha preparation ritual.", type: "Arts" },
                    { title: "Gion District", icon: "üëò", desc: "Observe Geisha/Maiko culture in Kyoto's historic streets.", type: "Arts" }
                ],
                food: [
                    { name: "Ramen", type: "Noodle", desc: "Wheat noodles in broth (Miso, Tonkotsu, Shoyu).", icon: "üçú" },
                    { name: "Udon", type: "Noodle", desc: "Thick, chewy wheat noodles, often in simple broth.", icon: "üç≤" },
                    { name: "Takoyaki", type: "Street Food", desc: "Octopus balls, savory and hot. Best in Osaka.", icon: "üêô" },
                    { name: "Okonomiyaki", type: "Street Food", desc: "Savory pancake with cabbage and toppings.", icon: "ü•û" },
                    { name: "Sushi", type: "Seafood", desc: "Vinegared rice with raw fish toppings.", icon: "üç£" },
                    { name: "Sashimi", type: "Seafood", desc: "Fresh, thinly sliced raw fish without rice.", icon: "üêü" }
                ],
                packing: [
                    { item: "Japan Rail Pass", note: "Purchase before arrival or online", packed: false },
                    { item: "Type A Power Adapter", note: "2-pin flat blades (US style)", packed: false },
                    { item: "Slip-on Shoes", note: "Essential for frequent removal at temples", packed: false },
                    { item: "Comfortable Layers", note: "For walking and changing weather", packed: false },
                    { item: "Cash (Yen)", note: "Stock up at 7-Eleven ATMs", packed: false }
                ],
                packing2: [
                    { item: "Pyjama", packed: false },
                    { item: "Underwaer", packed: false},
                    { item: "Toileteries", packed: false },
                    { item: "T-shirts", packed: false },
                    { item: "Jumper", packed: false},
                    { item: "Jeans", packed: false },
                    { item: "Sun-glasses", packed: false }
                ]
            },

            init: function() {
                this.switchTab(this.state.currentTab); // <--- FIXED: Call switchTab first to make the container visible
                this.renderLogistic();
                // Removed redundant this.attachToggleListeners();
                this.renderItinerary();
                this.renderExperiences();
                this.renderFood(this.state.food); 
                this.renderPacking();
                this.renderPacking2();
                // this.initCharts(); // Charts are commented out in HTML, so no need to call initCharts
            },

            switchTab: function(tabName) {
                // Hide all views
                document.querySelectorAll('[id^="view-"]').forEach(el => {
                    el.classList.add('hidden');
                    el.classList.remove('block');
                });
                
                // Show selected view
                const view = document.getElementById(`view-${tabName}`);
                if (view) { // Check if the element exists
                    view.classList.remove('hidden');
                    view.classList.add('block');
                    view.classList.add('animate-fade-in');
                }

                // Update Nav States
                document.querySelectorAll('nav button').forEach(btn => {
                    btn.classList.remove('active-tab');
                    btn.classList.add('inactive-tab');
                });
                const activeBtn = document.getElementById(`nav-${tabName}`);
                if(activeBtn) {
                    activeBtn.classList.remove('inactive-tab');
                    activeBtn.classList.add('active-tab');
                }
            },

            renderItinerary: function() {
                const container = document.getElementById('itinerary-list');
                container.innerHTML = this.state.itineraryData.map(dest => `
                    <div class="interactive-card bg-stone-50 p-4 rounded-lg border-l-4 border-stone-300 hover:border-orange-500 hover:bg-white transition-all duration-200">
                        <div class="flex justify-between items-start">
                            <h3 class="font-bold text-lg text-stone-800">${dest.city}</h3>
                            <span class="text-xs font-semibold bg-stone-200 text-stone-600 px-2 py-1 rounded-full">~${dest.days} Days</span>
                        </div>
                        <div class="flex flex-wrap gap-2 mt-2 mb-2">
                            ${dest.tags.map(tag => `<span class="text-[10px] uppercase tracking-wider bg-orange-100 text-orange-700 px-2 py-0.5 rounded">${tag}</span>`).join('')}
                        </div>
                        <p class="text-sm text-stone-600 mt-2">${dest.desc}</p>
                    </div>
                `).join('');
            },

            renderLogistic: function() {
                const container = document.getElementById('logistic-list');
                container.innerHTML = this.state.logisticData.map((dest, i) => `
                    <div class="interactive-card bg-stone-50 p-4 rounded-lg border-l-4 border-stone-300 hover:border-orange-500 hover:bg-white transition-all duration-200">
                        
                        <div class="flex items-start justify-between w-full"> 
                            
                            <div class="flex-grow pr-4"> 
                                <div id="header-${i}" class="flex justify-between items-start cursor-pointer toggle-btn" data-target="details-${i}">
                                    <h3 class="font-bold text-lg text-stone-800">${dest.city}</h3>
                                    <span class="text-xs font-semibold bg-stone-200 text-stone-600 px-2 py-1 rounded-full">~${dest.days} Days</span>
                                </div>
                                
                                <p class="text-sm text-stone-600 mt-2">${dest.shortDesc}</p>
                            </div>
                            
                            <a href="${dest.mapLink}" target="_blank" class="flex-shrink-0 w-12 h-12 flex items-center justify-center bg-red-100 rounded-full text-red-600 text-2xl hover:bg-red-200 transition duration-200" title="View on Google Maps">
                                üìç
                            </a>
                            
                        </div>

                        <div id="details-${i}" class="hidden mt-4 pt-3 border-t border-stone-200 more-info-panel">
                            <p class="text-sm text-stone-700 font-medium">${dest.fullDesc}</p>
                            <a href="${dest.bookingLink}" target="_blank" class="mt-3 inline-block text-sm font-semibold text-orange-600 hover:text-orange-700 transition duration-150">
                                üîó View Booking Link
                            </a>
                        </div>
                    </div>
                `).join('');
                
                // Attach the toggle event listener after rendering
                this.attachToggleListeners();
            },

            attachToggleListeners: function() {
                // Select all elements with the class 'toggle-btn' (our clickable headers)
                const toggleButtons = document.querySelectorAll('.toggle-btn');

                toggleButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        // Get the ID of the details panel from the 'data-target' attribute
                        const targetId = this.getAttribute('data-target');
                        const targetPanel = document.getElementById(targetId);
                        
                        // Toggle the 'hidden' class on the details panel
                        if (targetPanel.classList.contains('hidden')) {
                            // Show the panel
                            targetPanel.classList.remove('hidden');
                        } else {
                            // Hide the panel
                            targetPanel.classList.add('hidden');
                        }
                    });
                });
            },
            renderExperiences: function() {
                const container = document.getElementById('experience-grid');
                container.innerHTML = this.state.experiences.map(exp => `
                    <div class="interactive-card bg-white p-6 rounded-xl border border-stone-200 text-center flex flex-col items-center h-full">
                        <div class="text-4xl mb-4 p-4 bg-stone-50 rounded-full w-20 h-20 flex items-center justify-center">${exp.icon}</div>
                        <h4 class="font-bold text-lg text-stone-800 mb-2">${exp.title}</h4>
                        <span class="text-xs uppercase font-bold text-stone-400 mb-3 tracking-wide">${exp.type}</span>
                        <p class="text-sm text-stone-600">${exp.desc}</p>
                    </div>
                `).join('');
            },

            filterFood: function(type) {
                const filtered = type === 'all' 
                    ? this.state.food 
                    : this.state.food.filter(f => f.type === type);
                this.renderFood(filtered);
            },

            renderFood: function(data) {
                const container = document.getElementById('food-grid');
                container.innerHTML = data.map(item => `
                    <div class="interactive-card flex items-center p-3 bg-stone-50 rounded-lg border border-transparent hover:border-red-200 hover:bg-red-50 transition">
                        <span class="text-3xl mr-4">${item.icon}</span>
                        <div>
                            <h4 class="font-bold text-stone-800">${item.name}</h4>
                            <p class="text-xs text-stone-500">${item.desc}</p>
                            <span class="text-[10px] text-red-500 font-semibold uppercase mt-1 inline-block">${item.type}</span>
                        </div>
                    </div>
                `).join('');
            },

            // Function to update the status and re-render the list
            togglePacked: function(index) {
                // 1. Invert the 'packed' status
                const currentStatus = this.state.packing[index].packed;
                this.state.packing[index].packed = !currentStatus;

                // 2. Re-render the list immediately to show the change
                this.renderPacking(); 
            },

            togglePacked2: function(index) {
                // 1. Invert the 'packed' status of the item in the packing2 array
                const currentStatus = this.state.packing2[index].packed;
                this.state.packing2[index].packed = !currentStatus;

                // 2. Re-render the SECOND list
                this.renderPacking2(); 
            },

            // The completely replaced rendering function
            renderPacking: function() {
                const container = document.getElementById('packing-list');
                // Check if the container exists before attempting to render
                if (!container) return; 
                container.innerHTML = this.state.packing.map((item, index) => {
                    // Conditionally apply the CSS class for styling the text
                    const textClass = item.packed ? 'packed-text' : 'text-stone-800';
                    // Conditionally apply Tailwind classes for the box/check style
                    const boxStyle = item.packed 
                        ? 'bg-blue-500 border-blue-500' // Blue background when checked
                        : 'bg-white border-stone-300 group-hover:border-blue-400'; // White/stone background when unchecked

                    // Conditionally show the checkmark icon (tailwind)
                    const checkmark = item.packed ? `<svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>` : '';
                    
                    return `
                        <li class="flex items-start cursor-pointer group" onclick="app.togglePacked(${index})">
                            
                            <div class="flex-shrink-0 h-5 w-5 border rounded mr-3 mt-0.5 flex items-center justify-center transition-colors duration-200 ${boxStyle}">
                                ${checkmark}
                            </div>

                            <div class="flex-grow">
                                <p class="font-medium ${textClass}">${item.item}</p>
                                <p class="text-xs text-stone-500 ${textClass}">${item.note}</p>
                            </div>
                        </li>
                    `;
                }).join('');
            },

            renderPacking2: function() {
                const container = document.getElementById('packing2-list');
                if (!container) return; 

                // Note: The structure of packing2 items is simpler (no 'note' field), 
                // so we adjust the rendering slightly.
                container.innerHTML = this.state.packing2.map((item, index) => {
                    const textClass = item.packed ? 'packed-text' : 'text-stone-800';
                    const boxStyle = item.packed 
                        ? 'bg-blue-500 border-blue-500' 
                        : 'bg-white border-stone-300 group-hover:border-blue-400'; 

                    const checkmark = item.packed 
                        ? `<svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>` 
                        : '';
                    
                    return `
                        <li class="flex items-start cursor-pointer group" onclick="app.togglePacked2(${index})">
                            
                            <div class="flex-shrink-0 h-5 w-5 border rounded mr-3 mt-0.5 flex items-center justify-center transition-colors duration-200 ${boxStyle}">
                                ${checkmark}
                            </div>

                            <div class="flex-grow">
                                <p class="font-medium ${textClass}">${item.item}</p>
                                </div>
                        </li>
                    `;
                }).join('');
            },

            convertCurrency: function() {
                const input = document.getElementById('gbp-input').value;
                const output = document.getElementById('jpy-output');
                if (input) {
                    const result = (input * this.state.exchangeRate).toLocaleString('ja-JP', { style: 'currency', currency: 'JPY' });
                    output.innerText = result;
                    output.classList.add('text-green-700');
                } else {
                    output.innerText = "¬• 0";
                    output.classList.remove('text-green-700');
                }
            },

            initCharts: function() {
                // Itinerary Chart (Days distribution)
                const ctxItinerary = document.getElementById('itineraryChart').getContext('2d');
                new Chart(ctxItinerary, {
                    type: 'bar',
                    data: {
                        labels: this.state.itineraryData.map(d => d.city),
                        datasets: [{
                            label: 'Suggested Days',
                            data: this.state.itineraryData.map(d => d.days),
                            backgroundColor: ['#f97316', '#ea580c', '#c2410c', '#9a3412'], // Oranges
                            borderRadius: 6,
                            borderSkipped: false
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: { 
                                backgroundColor: '#fff', 
                                titleColor: '#44403c', 
                                bodyColor: '#44403c', 
                                borderColor: '#e7e5e4', 
                                borderWidth: 1,
                                callbacks: { label: (c) => `${c.raw} Days` } 
                            }
                        },
                        scales: {
                            y: { beginAtZero: true, display: false },
                            x: { grid: { display: false } }
                        }
                    }
                });

                // Food Chart (Pie)
                const ctxFood = document.getElementById('foodChart').getContext('2d');
                new Chart(ctxFood, {
                    type: 'doughnut',
                    data: {
                        labels: ['Noodles (Lunch)', 'Street Food (Snacks)', 'Seafood (Dinner)'],
                        datasets: [{
                            data: [40, 30, 30],
                            backgroundColor: ['#fca5a5', '#f87171', '#ef4444'], // Reds
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom', labels: { usePointStyle: true, font: {size: 10} } }
                        }
                    }
                });

                // Budget Chart (Pie)
                const ctxBudget = document.getElementById('budgetChart').getContext('2d');
                new Chart(ctxBudget, {
                    type: 'pie',
                    data: {
                        labels: ['Transport (JR Pass)', 'Accommodation', 'Food & Dining', 'Activities/Misc'],
                        datasets: [{
                            data: [25, 35, 30, 10], // Estimated breakdown
                            backgroundColor: ['#3b82f6', '#10b981', '#f59e0b', '#8b5cf6'],
                            borderWidth: 2,
                            borderColor: '#fff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'right', labels: { boxWidth: 12, padding: 15 } }
                        }
                    }
                });
            }
        };

        // Initialize on load
        window.onload = function() {
            app.init();
        };


        // Test budget record
        // 1. Data Store
        let expenses = [];
        
        // 2. Main function to add an expense
        function addExpense() {
            const itemInput = document.getElementById('expense-item');
            const costInput = document.getElementById('expense-cost');

            const item = itemInput.value.trim();
            const cost = parseFloat(costInput.value);

            // Basic validation
            if (item === "" || isNaN(cost) || cost <= 0) {
                alert("Please enter a valid item name and cost.");
                return;
            }

            // Add the new expense object to the array
            expenses.push({ 
                id: Date.now(), // Unique ID for deletion
                item: item, 
                cost: cost 
            });

            // Clear inputs after adding
            itemInput.value = '';
            costInput.value = '';
            
            // Update the table and total
            renderExpenses();
        }

        // 3. Function to delete an expense
        function deleteExpense(idToDelete) {
            // Filter out the expense with the matching ID
            expenses = expenses.filter(expense => expense.id !== idToDelete);
            
            // Update the table and total
            renderExpenses();
        }

        // 4. Function to render the table rows and calculate the total
        function renderExpenses() {
            const listBody = document.getElementById('expense-list');
            const totalCell = document.getElementById('total-cost');
            let total = 0;
            
            // Clear previous rows
            listBody.innerHTML = '';

            // Iterate through the array and build the HTML rows
            expenses.forEach(expense => {
                total += expense.cost; // Add to running total
                
                // Format the cost to two decimal places
                const formattedCost = expense.cost.toFixed(2);

                // Create the table row HTML
                const row = `
                    <tr>
                        <td>${expense.item}</td>
                        <td class="text-right">¬£ ${formattedCost}</td>
                        <td><button class="delete-btn" onclick="deleteExpense(${expense.id})">X</button></td>
                    </tr>
                `;
                listBody.innerHTML += row;
            });

            // Update the grand total display
            const formattedTotal = total.toFixed(2);
            totalCell.textContent = `¬£ ${formattedTotal}`;
        }

        // Optional: Render initial state when the script loads
        renderExpenses(); 
    </script>
</body>
</html>
